export const metadata = {
  title: 'é”™è¯¯å¤„ç†',
  description: 'äº†è§£ API å¯èƒ½è¿”å›çš„é”™è¯¯ç±»å‹ä»¥åŠå¦‚ä½•æ­£ç¡®å¤„ç†è¿™äº›é”™è¯¯ã€‚',
}

# é”™è¯¯å¤„ç†

æœ¬é¡µé¢è¯¦ç»†è¯´æ˜ API å¯èƒ½è¿”å›çš„å„ç§é”™è¯¯ç±»å‹ï¼Œä»¥åŠå¦‚ä½•åœ¨æ‚¨çš„åº”ç”¨ä¸­æ­£ç¡®å¤„ç†è¿™äº›é”™è¯¯ã€‚{{ className: 'lead' }}

---

## é”™è¯¯å“åº”æ ¼å¼ {{ id: 'error-format' }}

æ‰€æœ‰é”™è¯¯å“åº”éƒ½éµå¾ªç»Ÿä¸€çš„æ ¼å¼ï¼š

```json {{ title: 'é”™è¯¯å“åº”ç»“æ„' }}
{
  "success": false,
  "error": "é”™è¯¯æè¿°ä¿¡æ¯",
  "code": "ERROR_CODE",
  "message": "è¯¦ç»†çš„é”™è¯¯è¯´æ˜ï¼ˆå¯é€‰ï¼‰",
  "rateLimit": {
    "remaining": 497,
    "limit": 500,
    "reset": "2025-10-24T00:00:00.000Z"
  }
}
```

<Properties>
  <Property name="success" type="boolean">
    å§‹ç»ˆä¸º `false`ï¼Œè¡¨ç¤ºè¯·æ±‚å¤±è´¥
  </Property>
  <Property name="error" type="string">
    ç®€çŸ­çš„é”™è¯¯æè¿°ï¼Œé€‚åˆç›´æ¥æ˜¾ç¤ºç»™ç”¨æˆ·
  </Property>
  <Property name="code" type="string">
    é”™è¯¯ä»£ç ï¼Œç”¨äºç¨‹åºåˆ¤æ–­é”™è¯¯ç±»å‹
  </Property>
  <Property name="message" type="string">
    è¯¦ç»†çš„é”™è¯¯è¯´æ˜ï¼Œå¯èƒ½åŒ…å«è§£å†³å»ºè®®ï¼ˆå¯é€‰ï¼‰
  </Property>
  <Property name="rateLimit" type="object">
    Rate Limit ä¿¡æ¯ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
  </Property>
</Properties>

---

## é”™è¯¯ç±»å‹ {{ id: 'error-types' }}

### NOT_FOUND {{ tag: '404', label: 'Not Found' }}

<Row>
  <Col>
    **åŸå› ï¼š**å•è¯å°šæœªç”Ÿæˆè®°å¿†å¡ç‰‡

    å½“æ‚¨æŸ¥è¯¢çš„å•è¯ä¸åœ¨æ•°æ®åº“ä¸­æ—¶è¿”å›æ­¤é”™è¯¯ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºï¼š
    - å•è¯æ˜¯ç”Ÿåƒ»è¯æˆ–ä¸“ä¸šæœ¯è¯­
    - å•è¯æ‹¼å†™é”™è¯¯
    - è¯¥è¯­è¨€çš„å•è¯åº“å°šæœªæ”¶å½•æ­¤è¯

    **è§£å†³æ–¹æ¡ˆï¼š**
    - æ£€æŸ¥å•è¯æ‹¼å†™æ˜¯å¦æ­£ç¡®
    - å°è¯•å…¶ä»–å¸¸ç”¨å•è¯
    - è”ç³»ç®¡ç†å‘˜ç”³è¯·æ·»åŠ è¯¥å•è¯
  </Col>
  <Col sticky>
    ```json {{ title: '404 ç¤ºä¾‹' }}
    {
      "success": false,
      "error": "è¯¥å•è¯æš‚æœªç”Ÿæˆè®°å¿†å¡ç‰‡",
      "code": "NOT_FOUND",
      "message": "å•è¯ \"studyology\" (en) å°šæœªç”Ÿæˆè®°å¿†å¡ç‰‡ã€‚è¯·è”ç³»ç®¡ç†å‘˜æˆ–ç­‰å¾…åç»­æ›´æ–°ã€‚",
      "rateLimit": {
        "remaining": 497,
        "limit": 500,
        "reset": "2025-10-24T00:00:00.000Z"
      }
    }
    ```
  </Col>
</Row>

---

### RATE_LIMIT_EXCEEDED {{ tag: '429', label: 'Too Many Requests' }}

<Row>
  <Col>
    **åŸå› ï¼š**è¶…è¿‡æ¯æ—¥è¯·æ±‚é™é¢

    æ¯ä¸ª IP åœ°å€æ¯å¤©æœ‰ 500 æ¬¡å…è´¹è¯·æ±‚ã€‚è¶…è¿‡æ­¤é™é¢åä¼šè¿”å›æ­¤é”™è¯¯ã€‚

    **è§£å†³æ–¹æ¡ˆï¼š**
    - ç­‰å¾…é…é¢é‡ç½®ï¼ˆæ¯å¤© UTC 0:00ï¼‰
    - å®ç°å®¢æˆ·ç«¯ç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚
    - ç”³è¯·åŠ å…¥ IP ç™½åå•è·å¾—æ›´é«˜é…é¢
    - ä¼˜åŒ–è¯·æ±‚ç­–ç•¥ï¼Œå‡å°‘ä¸å¿…è¦çš„æŸ¥è¯¢

    **æ³¨æ„ï¼š** 429 å“åº”æœ¬èº«ä¸ä¼šæ¶ˆè€—é…é¢
  </Col>
  <Col sticky>
    ```json {{ title: '429 ç¤ºä¾‹' }}
    {
      "success": false,
      "error": "è¯·æ±‚æ¬¡æ•°å·²è¾¾ä»Šæ—¥ä¸Šé™",
      "code": "RATE_LIMIT_EXCEEDED",
      "rateLimit": {
        "remaining": 0,
        "limit": 500,
        "reset": "2025-10-24T00:00:00.000Z"
      }
    }
    ```

    <Note>
      æŸ¥çœ‹å“åº”ä¸­çš„ `rateLimit.reset` å­—æ®µäº†è§£é…é¢ä½•æ—¶é‡ç½®ã€‚
    </Note>
  </Col>
</Row>

---

### INVALID_PARAMETER {{ tag: '400', label: 'Bad Request' }}

<Row>
  <Col>
    **åŸå› ï¼š**è¯·æ±‚å‚æ•°ä¸ç¬¦åˆè¦æ±‚

    å¸¸è§æƒ…å†µï¼š
    - `word` å‚æ•°ä¸ºç©ºæˆ–æœªæä¾›
    - `word` é•¿åº¦è¶…è¿‡ 100 ä¸ªå­—ç¬¦
    - `word` å‚æ•°ç±»å‹ä¸æ­£ç¡®

    **è§£å†³æ–¹æ¡ˆï¼š**
    - ç¡®ä¿ `word` å‚æ•°ä¸ºéç©ºå­—ç¬¦ä¸²
    - é™åˆ¶è¾“å…¥é•¿åº¦åœ¨ 1-100 ä¸ªå­—ç¬¦
    - å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå‰ç«¯éªŒè¯
  </Col>
  <Col sticky>
    ```json {{ title: '400 ç¤ºä¾‹' }}
    {
      "success": false,
      "error": "å‚æ•°é”™è¯¯ï¼šword å‚æ•°å¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²",
      "code": "INVALID_PARAMETER",
      "rateLimit": {
        "remaining": 496,
        "limit": 500,
        "reset": "2025-10-24T00:00:00.000Z"
      }
    }
    ```
  </Col>
</Row>

---

### INTERNAL_ERROR {{ tag: '500', label: 'Internal Server Error' }}

<Row>
  <Col>
    **åŸå› ï¼š**æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

    è¿™æ˜¯æœåŠ¡å™¨ç«¯çš„é—®é¢˜ï¼Œå¯èƒ½ç”±ä»¥ä¸‹åŸå› å¼•èµ·ï¼š
    - æ•°æ®åº“è¿æ¥å¤±è´¥
    - æœåŠ¡å™¨è¿‡è½½
    - ç¨‹åºå¼‚å¸¸

    **è§£å†³æ–¹æ¡ˆï¼š**
    - ç­‰å¾…ç‰‡åˆ»åé‡è¯•
    - å¦‚æœé—®é¢˜æŒç»­ï¼Œè”ç³»æŠ€æœ¯æ”¯æŒ
    - å®ç°é‡è¯•æœºåˆ¶ï¼ˆå»ºè®®æŒ‡æ•°é€€é¿ï¼‰
  </Col>
  <Col sticky>
    ```json {{ title: '500 ç¤ºä¾‹' }}
    {
      "success": false,
      "error": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯",
      "code": "INTERNAL_ERROR"
    }
    ```

    <Note>
      æœåŠ¡å™¨é”™è¯¯é€šå¸¸ä¸åŒ…å« `rateLimit` ä¿¡æ¯ã€‚
    </Note>
  </Col>
</Row>

---

### NETWORK_ERROR {{ tag: 'CLIENT', label: 'Network Error' }}

<Row>
  <Col>
    **åŸå› ï¼š**ç½‘ç»œè¿æ¥å¤±è´¥

    è¿™æ˜¯å®¢æˆ·ç«¯çš„ç½‘ç»œé—®é¢˜ï¼š
    - æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨
    - è¯·æ±‚è¶…æ—¶
    - DNS è§£æå¤±è´¥

    **è§£å†³æ–¹æ¡ˆï¼š**
    - æ£€æŸ¥ç½‘ç»œè¿æ¥
    - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
    - éªŒè¯ API åœ°å€æ˜¯å¦æ­£ç¡®
    - å®ç°è¶…æ—¶å’Œé‡è¯•æœºåˆ¶
  </Col>
  <Col sticky>
    ```js {{ title: 'å®¢æˆ·ç«¯é”™è¯¯ç¤ºä¾‹' }}
    try {
      const response = await fetch(apiUrl)
      const data = await response.json()
    } catch (error) {
      // ç½‘ç»œé”™è¯¯
      console.error('ç½‘ç»œè¯·æ±‚å¤±è´¥:', error)
      return {
        success: false,
        error: 'ç½‘ç»œè¿æ¥å¤±è´¥',
        code: 'NETWORK_ERROR'
      }
    }
    ```
  </Col>
</Row>

---

## é”™è¯¯å¤„ç†æœ€ä½³å®è·µ {{ id: 'best-practices' }}

### 1. æ ¹æ®é”™è¯¯ç å¤„ç†

<CodeGroup>

```js {{ title: 'JavaScript' }}
async function handleWordQuery(word) {
  try {
    const response = await fetch(
      `https://api.keykey.cc/api/public/memory-card?word=${word}`
    )
    const data = await response.json()
    
    if (!data.success) {
      switch (data.code) {
        case 'NOT_FOUND':
          showMessage('å•è¯æœªæ”¶å½•ï¼Œè¯·å°è¯•å…¶ä»–å•è¯')
          break
        
        case 'RATE_LIMIT_EXCEEDED':
          const resetTime = new Date(data.rateLimit.reset)
          showMessage(`è¯·æ±‚æ¬¡æ•°å·²ç”¨å®Œï¼Œ${resetTime.toLocaleString()} åé‡ç½®`)
          break
        
        case 'INVALID_PARAMETER':
          showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„å•è¯')
          break
        
        case 'INTERNAL_ERROR':
          showMessage('æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•')
          setTimeout(() => handleWordQuery(word), 3000) // 3ç§’åé‡è¯•
          break
        
        default:
          showMessage('å‘ç”ŸæœªçŸ¥é”™è¯¯')
      }
      return null
    }
    
    return data.data
  } catch (error) {
    showMessage('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ')
    return null
  }
}
```

```python {{ title: 'Python' }}
import requests
import time
from datetime import datetime

def handle_word_query(word: str):
    try:
        response = requests.get(
            'https://api.keykey.cc/api/public/memory-card',
            params={'word': word},
            timeout=10
        )
        data = response.json()
        
        if not data['success']:
            code = data.get('code')
            
            if code == 'NOT_FOUND':
                print('å•è¯æœªæ”¶å½•ï¼Œè¯·å°è¯•å…¶ä»–å•è¯')
            
            elif code == 'RATE_LIMIT_EXCEEDED':
                reset_time = datetime.fromisoformat(
                    data['rateLimit']['reset'].replace('Z', '+00:00')
                )
                print(f'è¯·æ±‚æ¬¡æ•°å·²ç”¨å®Œï¼Œ{reset_time} åé‡ç½®')
            
            elif code == 'INVALID_PARAMETER':
                print('è¯·è¾“å…¥æœ‰æ•ˆçš„å•è¯')
            
            elif code == 'INTERNAL_ERROR':
                print('æœåŠ¡å™¨é”™è¯¯ï¼Œ3ç§’åé‡è¯•...')
                time.sleep(3)
                return handle_word_query(word)  # é‡è¯•
            
            else:
                print('å‘ç”ŸæœªçŸ¥é”™è¯¯')
            
            return None
        
        return data['data']
        
    except requests.RequestException as error:
        print(f'ç½‘ç»œè¿æ¥å¤±è´¥: {error}')
        return None
```

</CodeGroup>

---

### 2. å®ç°é‡è¯•æœºåˆ¶

å¯¹äºä¸´æ—¶æ€§é”™è¯¯ï¼ˆå¦‚ç½‘ç»œé—®é¢˜ã€æœåŠ¡å™¨é”™è¯¯ï¼‰ï¼Œå®ç°æ™ºèƒ½é‡è¯•ï¼š

<CodeGroup>

```js {{ title: 'JavaScript é‡è¯•' }}
async function fetchWithRetry(url, maxRetries = 3, delay = 1000) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url)
      const data = await response.json()
      
      // æˆåŠŸæˆ–éä¸´æ—¶æ€§é”™è¯¯ï¼Œç›´æ¥è¿”å›
      if (data.success || 
          ['NOT_FOUND', 'RATE_LIMIT_EXCEEDED', 'INVALID_PARAMETER'].includes(data.code)) {
        return data
      }
      
      // æœåŠ¡å™¨é”™è¯¯ï¼Œç»§ç»­é‡è¯•
      if (data.code === 'INTERNAL_ERROR' && i < maxRetries - 1) {
        console.log(`é‡è¯• ${i + 1}/${maxRetries}ï¼Œ${delay}ms å...`)
        await new Promise(resolve => setTimeout(resolve, delay))
        delay *= 2 // æŒ‡æ•°é€€é¿
        continue
      }
      
      return data
    } catch (error) {
      // ç½‘ç»œé”™è¯¯ï¼Œç»§ç»­é‡è¯•
      if (i < maxRetries - 1) {
        console.log(`ç½‘ç»œé”™è¯¯ï¼Œé‡è¯• ${i + 1}/${maxRetries}`)
        await new Promise(resolve => setTimeout(resolve, delay))
        delay *= 2
      } else {
        return {
          success: false,
          error: 'ç½‘ç»œè¿æ¥å¤±è´¥',
          code: 'NETWORK_ERROR'
        }
      }
    }
  }
}
```

</CodeGroup>

---

### 3. å‹å¥½çš„ç”¨æˆ·æç¤º

æ ¹æ®ä¸åŒé”™è¯¯ç±»å‹æä¾›å‹å¥½çš„ç”¨æˆ·æç¤ºï¼š

```jsx {{ title: 'React é”™è¯¯æç¤ºç»„ä»¶' }}
function ErrorMessage({ error }) {
  const messages = {
    NOT_FOUND: {
      title: 'å•è¯æœªæ”¶å½•',
      description: 'è¯¥å•è¯æš‚æ—¶æ²¡æœ‰è®°å¿†å¡ç‰‡ï¼Œè¯·å°è¯•å…¶ä»–å•è¯',
      icon: 'ğŸ”',
      action: 'è¿”å›æœç´¢'
    },
    RATE_LIMIT_EXCEEDED: {
      title: 'è¯·æ±‚æ¬¡æ•°å·²ç”¨å®Œ',
      description: error.rateLimit 
        ? `å°†åœ¨ ${new Date(error.rateLimit.reset).toLocaleString()} é‡ç½®`
        : 'è¯·ç¨åå†è¯•',
      icon: 'â±ï¸',
      action: 'äº†è§£é™é€Ÿè§„åˆ™'
    },
    INVALID_PARAMETER: {
      title: 'è¾“å…¥æ ¼å¼é”™è¯¯',
      description: 'è¯·è¾“å…¥ 1-100 ä¸ªå­—ç¬¦çš„æœ‰æ•ˆå•è¯',
      icon: 'âš ï¸',
      action: 'é‡æ–°è¾“å…¥'
    },
    INTERNAL_ERROR: {
      title: 'æœåŠ¡å™¨é”™è¯¯',
      description: 'æˆ‘ä»¬æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨åé‡è¯•',
      icon: 'ğŸ”§',
      action: 'é‡è¯•'
    },
    NETWORK_ERROR: {
      title: 'ç½‘ç»œè¿æ¥å¤±è´¥',
      description: 'è¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥',
      icon: 'ğŸ“¡',
      action: 'é‡è¯•'
    }
  }
  
  const msg = messages[error.code] || {
    title: 'å‘ç”Ÿé”™è¯¯',
    description: error.error || 'æœªçŸ¥é”™è¯¯',
    icon: 'âŒ',
    action: 'è¿”å›'
  }
  
  return (
    <div className="rounded-lg border border-rose-200 bg-rose-50 p-6 dark:border-rose-900 dark:bg-rose-950/30">
      <div className="flex items-start gap-4">
        <span className="text-3xl">{msg.icon}</span>
        <div className="flex-1">
          <h3 className="text-lg font-semibold text-rose-900 dark:text-rose-400">
            {msg.title}
          </h3>
          <p className="mt-1 text-sm text-rose-700 dark:text-rose-300">
            {msg.description}
          </p>
          <button className="mt-4 rounded-lg bg-rose-600 px-4 py-2 text-sm font-medium text-white hover:bg-rose-700">
            {msg.action}
          </button>
        </div>
      </div>
    </div>
  )
}
```

---

## è°ƒè¯•æŠ€å·§ {{ id: 'debugging' }}

### æŸ¥çœ‹å®Œæ•´é”™è¯¯ä¿¡æ¯

åœ¨å¼€å‘ç¯å¢ƒä¸­è®°å½•å®Œæ•´çš„é”™è¯¯å“åº”ï¼š

```js
fetch(apiUrl)
  .then(res => res.json())
  .then(data => {
    if (!data.success) {
      console.group('API Error')
      console.log('Code:', data.code)
      console.log('Error:', data.error)
      console.log('Message:', data.message)
      console.log('Rate Limit:', data.rateLimit)
      console.groupEnd()
    }
  })
```

### ä½¿ç”¨æµè§ˆå™¨å¼€å‘å·¥å…·

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. æŸ¥çœ‹ API è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯
4. æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå“åº”ä½“

---

## ç›¸å…³èµ„æº {{ id: 'related-resources' }}

<div className="not-prose">
  <Button href="/rate-limits" variant="text" arrow="right">
    äº†è§£é™é€Ÿè§„åˆ™
  </Button>
</div>

<div className="not-prose">
  <Button href="/examples" variant="text" arrow="right">
    æŸ¥çœ‹å®Œæ•´çš„é”™è¯¯å¤„ç†ç¤ºä¾‹
  </Button>
</div>

<div className="not-prose">
  <Button href="/api-reference" variant="text" arrow="right">
    æŸ¥çœ‹ API å®Œæ•´æ–‡æ¡£
  </Button>
</div>
